# Start from ROS base image
FROM ros:humble-ros-base

# Make a catkin workspace
WORKDIR /
RUN mkdir -p /ros2_ws/src
WORKDIR /ros2_ws/src

SHELL [ "/bin/bash" , "-c" ]
# Install necessary dependencies
RUN apt-get update && apt-get install -y \
    git \
    build-essential \
   ros-humble-navigation2 \
   ros-humble-nav2-bringup

RUN git clone https://github.com/Combuster54/warehouse_setup ros2_ws/src/warehouse_nav2

# Build the Catkin workspace
RUN source /opt/ros/humble/setup.bash \
    && cd /ros2_ws \
    && colcon build

# Ensure the workspace is sourced
RUN echo "source /ros2_ws/install/setup.bash" >> ~/.bashrc

# Set the entry point to start the ROS launch file
ENTRYPOINT ["/bin/bash", "-c", "source /ros2_ws/install/setup.bash && ros2 launch path_planner_server nrviz_navigation.launch.py"]